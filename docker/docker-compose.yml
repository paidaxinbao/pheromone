# Agent Swarm - OpenClaw Docker 部署
# 使用本地构建的 openclaw:local 镜像

services:
  # Developer Agent
  developer:
    image: openclaw:local
    container_name: agent-swarm-developer
    environment:
      - GITHUB_TOKEN=${GITHUB_TOKEN}
      - OPENCLAW_MODEL=bailian/qwen3.5-plus
    volumes:
      - ./data/developer:/home/node/.openclaw
      - ../:/home/node/workspace:ro
    networks:
      - agent-network
    ports:
      - "18791:18789"
    working_dir: /home/node
    command: ["openclaw", "gateway", "--port", "18789", "--verbose", "--allow-unconfigured"]
    restart: unless-stopped

  # Reviewer Agent
  reviewer:
    image: openclaw:local
    container_name: agent-swarm-reviewer
    environment:
      - GITHUB_TOKEN=${GITHUB_TOKEN}
      - OPENCLAW_MODEL=bailian/qwen3.5-plus
    volumes:
      - ./data/reviewer:/home/node/.openclaw
      - ../:/home/node/workspace:ro
    networks:
      - agent-network
    ports:
      - "18792:18789"
    working_dir: /home/node
    command: ["openclaw", "gateway", "--port", "18789", "--verbose", "--allow-unconfigured"]
    depends_on:
      - developer
    restart: unless-stopped

  # Tester Agent
  tester:
    image: openclaw:local
    container_name: agent-swarm-tester
    environment:
      - GITHUB_TOKEN=${GITHUB_TOKEN}
      - OPENCLAW_MODEL=bailian/qwen3.5-plus
    volumes:
      - ./data/tester:/home/node/.openclaw
      - ../:/home/node/workspace:ro
    networks:
      - agent-network
    ports:
      - "18793:18789"
    working_dir: /home/node
    command: ["openclaw", "gateway", "--port", "18789", "--verbose", "--allow-unconfigured"]
    depends_on:
      - reviewer
    restart: unless-stopped

networks:
  agent-network:
    driver: bridge